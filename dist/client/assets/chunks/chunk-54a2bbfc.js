import{c as Z,d as $,a as G,f as C,i as l}from"./chunk-d8234155.js";import{r as n}from"./chunk-e9cd8943.js";import{I as T}from"./chunk-d80cdd1c.js";import{l as J}from"./chunk-ba3e3861.js";import{c as k}from"./chunk-99b8f121.js";import{c as E,i as L}from"./chunk-ff689da6.js";import{d as K}from"./chunk-fde55823.js";import{b as P}from"./chunk-d368c681.js";import{m as Q}from"./chunk-36a75920.js";import{u as U}from"./chunk-dcdbe767.js";import{L as z}from"./chunk-014979c9.js";import{L as X}from"./chunk-5f195378.js";import{A as Y}from"./chunk-43f2ddc7.js";import{C as H}from"./chunk-faa47c2c.js";import{C as ss}from"./chunk-41250ec8.js";import{a as c,j as r}from"./chunk-c1d16543.js";import"./chunk-cf010ec4.js";import"./chunk-634a8a63.js";import"./chunk-09d047a9.js";import"./chunk-acb1a683.js";import"./chunk-e3775f6c.js";/* empty css              */import"./chunk-23179642.js";import"./chunk-61229905.js";import"./chunk-0feb7138.js";import"./chunk-b745fb4d.js";import"./chunk-b4d6f2f0.js";import"./chunk-b720646a.js";import"./chunk-ec284ae6.js";import"./chunk-79739c92.js";import"./chunk-8f68cdf3.js";import"./chunk-b3e26e36.js";import"./chunk-1d6b0b39.js";import"./chunk-5dde6c82.js";import"./chunk-38ad52ab.js";/* empty css              */import"./chunk-5212edba.js";import"./chunk-6b5946cf.js";import"./chunk-cd3d6459.js";import"./chunk-ec38f500.js";import"./chunk-c1540bb6.js";import"./chunk-78c1d4c8.js";import"./chunk-cfcc25a6.js";import"./chunk-e9c2c122.js";import"./chunk-86e4740a.js";function rs(u,m){return{joinWidth:0,foundWidth:0,setJoinWidth:d=>{u(C(t=>{t.joinWidth=d}))},setFoundWidth:d=>{u(C(t=>{t.foundWidth=d}))}}}const os=Z($(rs,{name:"my-group"})),A=G(os),es={"my-group":"my-group-index-module__my-group--NdF"},ts={"group-com":"group-component-index-module__group-com--R8k"};function R(u){const{crewName:m,right:d,line:t=!0,img:f,icon:h="icon_address_book_new_friend",number:b,messageDisturb:p=!1,message:y,time:v}=u,{joinWidth:g,foundWidth:_}=A();return c("div",{className:ts["group-com"],children:[c("div",{className:"nav-item",children:[r("div",{className:"nav-item-left",children:r("div",{className:"nav-ico-box",children:r(H,{size:48,src:f,isGroup:!0})})}),c("div",{className:"nav-item-right",children:[c("div",{className:"right-top",children:[r("div",{children:c("div",{className:"group-name",children:[m,c("span",{className:"group-number",children:["(",b,")"]})]})}),r("div",{children:v})]}),c("div",{className:"right-bottom",children:[r("div",{className:k("w",(g===399||_===399)&&"message2",(g===479||_===479)&&"message3"),children:r(ss,{message:y})}),r("div",{children:p&&r(T,{name:"icon_chat_do_not_disturb"})})]})]})]}),t&&r("div",{className:"line"})]})}function Xs(){const u=K(),{setJoinWidth:m,setFoundWidth:d}=A(),[t,f]=n.useState(1),[h,b]=n.useState(),[p,y]=n.useState(),[v,g]=n.useState([]),[_,D]=n.useState(0),[I,S]=n.useState(!1),M=n.useRef(null),x=n.useRef(null),j=s=>{s==null||s.forEach(e=>{u.queryConversation(e.groupId,P.Group).then(o=>{var w;let N=o.conversation.lastMessage,O=(w=o.conversation.lastMessage)==null?void 0:w.timestamp,B=Q(O).format("HH:mm");g(V=>[...V,{groupId:e.groupId,lastMessage:N,timeStamp:B}])}).catch(()=>{g(o=>[...o,{groupId:e.groupId,lastMessage:null,timeStamp:null}])})})},q=async()=>{S(!0);const s=await L({queryType:"1"}),{isOk:e,data:o}=s||{};e&&(S(!1),b(o),j(o))},a=h==null?void 0:h.map(s=>{const e=v.find(o=>s.groupId===o.groupId?o:null);return{...s,...e}}),F=async()=>{const s=await L({queryType:"2"}),{isOk:e,data:o}=s||{};e&&(y(o),j(o))},i=p==null?void 0:p.map(s=>{const e=v.find(o=>s.groupId===o.groupId?o:null);return{...s,...e}});n.useEffect(()=>{q(),F()},[]),n.useEffect(()=>{var o,N;const s=(o=M.current)==null?void 0:o.clientWidth,e=(N=x.current)==null?void 0:N.clientWidth;m(s),d(e)},[t,_]);const{run:W}=U(()=>{D(window.innerWidth)},{wait:500});return n.useEffect(()=>(window.addEventListener("resize",W),()=>{window.removeEventListener("resize",W)}),[]),c("div",{className:es["my-group"],children:[r(Y,{titleText:l._("features_select_contact_index_ursogloihf")}),c("div",{className:"nav-item",onClick:()=>{J("/group/add-member")},children:[r("div",{className:"nav-ico-box",children:r(T,{name:"icon_address_book_group",fontSize:28,className:"icon-color"})}),r("div",{className:"nav-text",children:l._("features_messenger_my_group_index_bcypcolpmt")})]}),c("div",{className:"group-tabs",children:[r("div",{className:k("has-found-join",t===1&&"has-found-join-activate"),onClick:()=>{f(1)},children:l._("features_select_contact_group_iykozky04y")}),r("div",{className:k("has-found-join",t===2&&"has-found-join-activate"),onClick:()=>{f(2)},children:l._("features_select_contact_group_f2v65kjlnm")})]}),I?r("div",{className:"flex justify-center mt-40",children:r(X,{})}):r("div",{className:"found-list group-list",style:{display:t===1&&(a!=null&&a.length)?"block":"none"},children:a==null?void 0:a.map((s,e)=>r("div",{ref:x,onClick:()=>{E({group:s})},children:r(R,{crewName:s==null?void 0:s.groupName,messageDisturb:(s==null?void 0:s.messageDisturb)===2,number:s==null?void 0:s.number,time:s==null?void 0:s.timeStamp,message:s==null?void 0:s.lastMessage,img:s==null?void 0:s.headImage,line:a.length-1!==e})},s==null?void 0:s.groupId))}),I?null:!(a!=null&&a.length)&&t===1&&r(z,{text:l._("features_messenger_my_group_index_ezj8ubt9up")}),r("div",{className:"join-list group-list",style:{display:t===2&&(i!=null&&i.length)?"block":"none"},children:i==null?void 0:i.map((s,e)=>r("div",{ref:M,onClick:()=>{E({group:s})},children:r(R,{crewName:s==null?void 0:s.groupName,messageDisturb:(s==null?void 0:s.messageDisturb)===2,number:s==null?void 0:s.number,time:s==null?void 0:s.timeStamp,message:s==null?void 0:s.lastMessage,img:s==null?void 0:s.headImage,line:i.length-1!==e},s==null?void 0:s.groupId)},s==null?void 0:s.groupId))}),I?null:!(i!=null&&i.length)&&t===2&&r(z,{text:l._("features_messenger_my_group_index_7ha404uvph")})]})}export{Xs as default};
