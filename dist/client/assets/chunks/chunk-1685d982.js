import{u as se,i as o}from"./chunk-d8234155.js";import{r as i}from"./chunk-e9cd8943.js";/* empty css              */import{F as n,e as te,v as oe,p as re}from"./chunk-54123a3b.js";import{B as N}from"./chunk-23179642.js";import{I as u}from"./chunk-1a70223d.js";import{u as ie,q as ae,r as R}from"./chunk-fde55823.js";import{I as T}from"./chunk-d80cdd1c.js";import{u as ne}from"./chunk-cc4f6b84.js";import{L as le}from"./chunk-5212edba.js";import{I as ce}from"./chunk-38141c50.js";import{o as de}from"./chunk-99b8f121.js";import{l as x}from"./chunk-ba3e3861.js";import{L as me}from"./chunk-278fdecb.js";import{C as ue}from"./chunk-cb1a8670.js";import{c as _e,d as fe,g as pe,b as ge}from"./chunk-41ff5c14.js";import{a as he}from"./chunk-634a8a63.js";import{U as be}from"./chunk-18733530.js";import{j as e,a as f}from"./chunk-c1d16543.js";import{M as C}from"./chunk-36a75920.js";import"./chunk-cf010ec4.js";import"./chunk-77df718a.js";import"./chunk-38ad52ab.js";import"./chunk-b4d6f2f0.js";import"./chunk-0feb7138.js";import"./chunk-01660bad.js";import"./chunk-d4125093.js";import"./chunk-c1540bb6.js";import"./chunk-09d047a9.js";import"./chunk-acb1a683.js";import"./chunk-61229905.js";import"./chunk-b745fb4d.js";import"./chunk-3a21c360.js";/* empty css              */import"./chunk-bc20e779.js";import"./chunk-6b5946cf.js";import"./chunk-ec38f500.js";import"./chunk-260fa0dc.js";import"./chunk-f3e99ce8.js";function A(){return"/messenger"}const xe="login-index-module__scoped--aGj",ye={scoped:xe};let _=null;function ns(){const{setBusinessId:w,setAccessKey:I}=se(),{setUserInfo:v,setZimToken:S,setLogin:q}=ie(),[c,p]=i.useState(0),[B,k]=i.useState(""),[g,M]=i.useState(""),[Ne,L]=i.useState(""),[y,E]=i.useState(!1),[a,j]=i.useState("email"),[h,P]=i.useState("passwordLogin"),[F,d]=i.useState(!1);i.useState("");const[O,V]=i.useState(!1),[m]=n.useForm(),U=ne(),{redirect:b}=U.urlParsed.search,G=()=>{V(!0)},$=()=>{V(!1)},K=s=>{k(s.countryName),M(s.countryEnCode),L(s.countryShortName),m.setFieldValue("area",s.countryName)},W=()=>{ae({}).then(s=>{if(s.isOk&&s.data){let{countryName:r,countryShortName:t,countryEnCode:l}=s.data;k(r||""),M(l||""),L(t||""),m.setFieldValue("area",r)}})},Z=()=>{const s={mobile:{validateName:["account","area","serverId"],sendRequest:D},email:{validateName:["email","serverId"],sendRequest:H}};m.validate(s[a].validateName).then(()=>{s[a].sendRequest()}).catch(()=>{})},D=()=>{const{account:s}=m.getFieldsValue();pe({mobileNumber:s,mobileCountryCd:g,typeCd:"2"}).then(t=>{var l;t.isOk&&((l=t.data)!=null&&l.success)&&p(60)})},H=()=>{let r={email:m.getFieldValue("email"),typeCd:"2"};ge(r).then(t=>{var l;t.isOk&&((l=t.data)!=null&&l.success)&&p(60)})},J=()=>{E(!y)},Q=async s=>{{d(!0);const r=await he(s.serverId);if(r)w(s.serverId),r&&I(r);else{d(!1),I(""),w("1"),await C.error(o._("features_users_create_account_index_sysmxmxmi8"));return}}a==="mobile"?ee(s):Y(s)},z=s=>{j(s),p(0),_&&clearInterval(_)},X=()=>{P(h==="passwordLogin"?"codeLogin":"passwordLogin")},Y=async s=>{d(!0);const{isOk:r,data:t}=await _e({email:s.email,loginPassword:s.loginPassword,emailCode:s.code});d(!1),r&&(S((t==null?void 0:t.zeGoToken)||""),v({...t==null?void 0:t.userInfo}),q(!0),R(t),C.success(o._("features_users_login_index_pszpygvu5b")),b?x(b):x(A()))},ee=async s=>{d(!0);const{isOk:r,data:t}=await fe({mobileCountryCd:g,mobileNumber:s.account,loginPassword:s.loginPassword,mobileTelCode:s.code});d(!1),r&&(S((t==null?void 0:t.zeGoToken)||""),v({...t==null?void 0:t.userInfo}),R(t),q(!0),C.success(o._("features_users_login_index_pszpygvu5b")),b?x(b):x(A()))};return i.useEffect(()=>{W()},[]),i.useEffect(()=>(c>0?_=setInterval(()=>{p(s=>s-1)},1e3):clearInterval(_),()=>{_&&clearInterval(_)}),[c]),e(be,{children:f("div",{className:ye.scoped,children:[e(ce,{}),e("div",{className:"qcode-box",children:e("div",{className:"qcrode",children:e(le,{className:"overflow-hidden rounded-3xl",src:`${de}plogo.png`})})}),e(n,{form:m,layout:"vertical",onSubmit:Q,autoComplete:"off",validateTrigger:"onBlur",children:f("div",{className:"login-box",children:[e("h1",{className:"text-3xl text-text_color_01 font-semibold",children:o._("features_users_login_index_yj8rlwoy9d")}),e(n.Item,{className:"list-item server-box",field:"serverId",requiredSymbol:!1,rules:[{required:!0,message:o._("features_users_create_account_index_xhrbqemwnq")}],children:e(u,{autoComplete:"off",placeholder:o._("features_users_create_account_index_xhrbqemwnq"),className:"input-box"})}),e("div",{className:"tab-box",children:f("ul",{children:[e("li",{className:a==="email"?"active":"",onClick:()=>z("email"),children:o._("features_settings_center_personal_information_index_suyk940elg")}),e("li",{className:a==="mobile"?"active":"",onClick:()=>z("mobile"),children:o._("features_settings_center_personal_information_index_4sbsiya1gg")})]})}),f("div",{className:"login-content",children:[a==="mobile"&&e(n.Item,{className:"list-item cursor-pointer",field:"area",requiredSymbol:!1,rules:[{required:!0,message:o._("features_users_create_account_index_0dlxrrysk4")}],children:e(u,{readOnly:!0,value:B,onClick:G,suffix:e(T,{name:"icon_chat_arrow",fontSize:16,className:"text-icon_color pr-4"}),placeholder:o._("features_users_create_account_index_0dlxrrysk4"),className:"area"})}),a==="mobile"&&e(n.Item,{className:"list-item",field:"account",requiredSymbol:!1,rules:[{required:!0,message:o._("features_settings_center_bind_mobile_index_rocukuvszt")}],children:e(u,{addBefore:g?`+${g}`:"--",placeholder:o._("features_settings_center_bind_mobile_index_rocukuvszt"),className:"input-box"})}),a==="email"&&e(n.Item,{className:"list-item",field:"email",requiredSymbol:!1,rules:[te()],children:e(u,{placeholder:o._("features_users_create_account_index_jgkp094fey"),className:"input-box"})}),h==="codeLogin"&&e(n.Item,{className:"list-item last-item",requiredSymbol:!1,field:"code",rules:[oe(c>0)],children:e(u,{placeholder:a==="email"?o._("features_settings_center_verify_identidy_index_rwtzuuhnki"):o._("features_settings_center_bind_mobile_index_avn5naqutc"),className:"input-box",addAfter:e(N,{onClick:Z,disabled:c>0,className:"getcode pr-4",type:"text",children:c>0?`${c}s`:o._("features_users_create_account_index_dlm0wqw8rw")})})}),h==="passwordLogin"&&e(n.Item,{className:"list-item last-item",requiredSymbol:!1,field:"loginPassword",rules:[re()],children:e(u,{type:y?"text":"password",className:"input-box",suffix:e(T,{name:y?"icon_register_open":"icon_register_hide",fontSize:22,onClick:J,className:"password-icon pr-4 text-icon_color"}),placeholder:o._("features_users_create_account_index_uqp_bpomjo")})})]}),e("div",{className:"switch-box",onClick:X,children:e(N,{type:"default",long:!0,className:"switch-btn",children:h==="codeLogin"?o._("features_users_login_index_zdnovihqrb"):o._("features_users_login_index_xor_1rtwly")})}),e("div",{className:"w-full",children:e(N,{type:"primary",loading:F,long:!0,className:"commit-btn",htmlType:"submit",children:o._("features_users_login_index_6tiyoujrwd")})}),f("div",{className:"text-text_color_02 text-sm mt-6",children:[e("span",{children:o._("features_users_login_index_kvhniugxol")}),e(me,{href:"/register",className:"text-brand_color unline",children:o._("features_users_login_index_r_dc9gbbyo")})]})]})}),e(ue,{visible:O,onClose:$,onSelect:K})]})})}export{ns as default};
