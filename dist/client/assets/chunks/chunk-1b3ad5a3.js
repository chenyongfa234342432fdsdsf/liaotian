import{c as Y,d as Z,a as ee,f as se,i as a}from"./chunk-d8234155.js";import{p as ae,c as P,g as ne}from"./chunk-b720646a.js";import{r as o}from"./chunk-e9cd8943.js";/* empty css              */import{B as M}from"./chunk-23179642.js";import{I as R}from"./chunk-1a70223d.js";import{I as v}from"./chunk-d80cdd1c.js";import{a as U,c as re}from"./chunk-ff689da6.js";import{M as B,C as L}from"./chunk-3c42a90c.js";import{N as te}from"./chunk-28c62a8f.js";import{L as oe}from"./chunk-5f195378.js";import{U as ie,M as de,u as ce}from"./chunk-f88c8133.js";import{g as b}from"./chunk-53514b52.js";import{A as le}from"./chunk-43f2ddc7.js";import{C as F}from"./chunk-4e694d97.js";import{x as _e}from"./chunk-fde55823.js";import{M as fe}from"./chunk-61229905.js";import"./chunk-3a21c360.js";/* empty css              */import{a as pe,A as ue,b as he}from"./chunk-46a6e698.js";import{j as s,a as d,F as me}from"./chunk-c1d16543.js";import{M as S}from"./chunk-36a75920.js";import"./chunk-cf010ec4.js";import"./chunk-b4d6f2f0.js";import"./chunk-0feb7138.js";import"./chunk-01660bad.js";import"./chunk-d4125093.js";import"./chunk-c1540bb6.js";import"./chunk-99b8f121.js";import"./chunk-d368c681.js";import"./chunk-e3775f6c.js";import"./chunk-ec284ae6.js";import"./chunk-5212edba.js";import"./chunk-634a8a63.js";import"./chunk-09d047a9.js";import"./chunk-acb1a683.js";import"./chunk-6b5946cf.js";import"./chunk-b745fb4d.js";import"./chunk-cd3d6459.js";import"./chunk-ec38f500.js";import"./chunk-93e6d3ec.js";import"./chunk-8f68cdf3.js";import"./chunk-cfcc25a6.js";import"./chunk-e7397446.js";import"./chunk-faa47c2c.js";import"./chunk-ba3e3861.js";function ge(m,k){return{newFriendItem:{},setNewFriendItem:x=>{m(se(g=>{g.newFriendItem=x}))}}}const xe=Y(Z(ge,{name:"new-friend-store"})),V=ee(xe),Ne={"new-friend":"new-friend-index-module__new-friend--Ev9"},ve={"chat-complain-model":"user-complain-modal-index-module__chat-complain-model--AGu"},ke=R.TextArea;function ye({visible:m,setvisible:k,userInfo:x}){const[g,A]=o.useState(),[t,c]=o.useState("");let f;x.initiativeAdd?f=x.targetUid:f=x.uid;const l=async()=>{var i;const u=(g==null?void 0:g.map(T=>pe(T,he.im,ue.complain_application)))||[],p=await Promise.all(u),N=await _e({complaintType:1,complaintReason:t,complaintImage:p.join(","),complaintUid:f});N.isOk&&((i=N.data)!=null&&i.success)?(_(!1),S.success(a._("features_messenger_chat_information_modals_chat_complain_modal_index_vypvbrvdtg"))):(_(!1),S.error(a._("features_messenger_chat_information_modals_chat_complain_modal_index_9xd4v0bewm")))},[y,_]=o.useState(m);return o.useEffect(()=>{_(m)},[m]),o.useEffect(()=>{k(y)},[y]),s(fe,{autoFocus:!1,closable:!1,className:ve["chat-complain-model"],visible:m,onCancel:()=>_(!1),title:a._("features_messenger_chat_chat_header_more_qwqejeixxl"),footer:()=>d(me,{children:[s(M,{className:"ml-auto",type:"outline",onClick:()=>_(!1),children:a._("features_group_components_comfirm_btn_pop_index_2sr1guu0iy")}),s(M,{onClick:()=>l(),type:"primary",children:a._("features_messenger_chat_information_modals_chat_complain_modal_index_njx6ip3sh8")})]}),children:d("div",{children:[s("span",{className:"text-base text-text_color_01",children:a._("features_messenger_chat_information_modals_chat_complain_modal_index_t4sy5xghsn")}),s(ke,{onChange:c,showWordLimit:!0,maxLength:200}),s("div",{className:"text-base text-text_color_01 mt-6",children:a._("features_messenger_chat_information_modals_chat_complain_modal_index_2fq23veoy8")}),s("div",{className:"text-text_color_02 text-xs mb-3",children:a._("features_messenger_chat_information_modals_chat_complain_modal_index_kqg5woa3og")}),s(ie,{multiple:!0,limit:5,action:"/",listType:"picture-card",onChange:(u,p)=>{const N=u==null?void 0:u.map(i=>i==null?void 0:i.originFile);N&&A(N)}})]})})}const we="stranger-index-module__stranger--TnC",Se={stranger:we};function Ae(m){const{setApplyList:k}=U(),[x,g]=o.useState(!1),{onClose:A}=m,{newFriendItem:t}=V(),[c,f]=o.useState(!1),l=async()=>{if(t!=null&&t.initiativeAdd||(t==null?void 0:t.applyStatus)!==1){const _=await ae({uid:t==null?void 0:t.targetUid}),{isOk:u,data:p}=_||{};u&&(p!=null&&p.success)?(f(!1),S.success(a._("features_messenger_addition_index_t0o7celfir"))):(f(!1),S.error(a._("features_messenger_addition_index_79dzbswbuk")))}else{const _=await P({recordId:t==null?void 0:t.recordId}),{isOk:u,data:p}=_||{};u&&(p!=null&&p.success)?(f(!1),S.success(a._("features_messenger_new_friend_stranger_index_4ahi2ggjls")),k()):(f(!1),S.error(a._("features_messenger_new_friend_stranger_index_yu9yxtmlq_")))}},y=_=>{g(_)};return d("div",{className:Se.stranger,children:[s(de,{onClose:A,title:a._("features_messenger_new_friend_stranger_index_5nq5jufpaa")}),s("div",{className:"flex justify-center items-center py-8 header",children:d("div",{children:[s("div",{className:"w-48 h-48",style:{borderRadius:"50%"},children:s("img",{src:"https://oss.chainstar.cloud/im-web/image/defaultheadurl.png",alt:"",width:200,height:200})}),s("div",{className:"text-center name",children:t==null?void 0:t.nickName})]})}),d("div",{className:"add-friend",onClick:()=>{f(!0)},children:[s(v,{name:"icon_address_book_invite_friend",className:"ml-6 mr-4",fontSize:20}),a._("features_messenger_chat_information_chat_settings_schema_tgrf_5rcdi")]}),d("div",{className:"complain add-friend",onClick:()=>{g(!0)},children:[s(v,{name:"icon_chat_complaint",className:"ml-6 mr-4",fontSize:20}),a._("features_messenger_chat_chat_header_more_vegbnukvgl")]}),s(ye,{visible:x,setvisible:y,userInfo:t}),c&&s(B,{children:s(L,{title:t.nickName,content:a._("features_messenger_addition_index_1fx0wn_hbe"),confirmEvent:()=>{l()},cancelEvent:()=>{f(!1)}})})]})}function xs(){const[m,k]=ce(),{setNewFriendItem:x}=V(),{addressBookList:g,setAddressBookList:A,applyList:t}=U(),[c,f]=o.useState([]),[l,y]=o.useState(""),[_,u]=o.useState(""),[p,N]=o.useState(!1),[i,T]=o.useState({recordId:"",nickName:""}),[w,j]=o.useState([]),[O,I]=o.useState(!1),C=3,z=c==null?void 0:c.filter(n=>b(n.applyTime)<=C?n:null),$=c==null?void 0:c.filter(n=>b(n.applyTime)>C?n:null),G=w==null?void 0:w.filter(n=>b(n.applyTime)<=C?n:null),W=w==null?void 0:w.filter(n=>b(n.applyTime)>C?n:null),H=async n=>{const r=await P({recordId:n});r!=null&&r.data&&(N(!1),u(i.nickName))},q=async()=>{I(!0);const n=await ne({});I(!1);const{isOk:r,data:e}=n||{};r&&e&&f(e)};o.useEffect(()=>{q(),A()},[t]);const J=c==null?void 0:c.filter(n=>{var r;return(r=n.nickName)!=null&&r.toLowerCase().includes(l.toLowerCase())?n:null});o.useEffect(()=>{j(l===""?[]:J)},[l]);const D=n=>{const r=g.filter(e=>e.nickName===n.nickName?e:null);r.length===0&&(x(n),m(s(Ae,{onClose:k}))),r.length>0&&(k(),re({friend:r[0]}))};function E(n,r){return d("div",{className:"scroll-show",children:[!!(n!=null&&n.length)&&d("div",{className:"new-friends-list near",children:[s("div",{className:"new-friends-lis-title",children:a._("features_messenger_new_friend_index_rv5hzy39dd")}),s("div",{children:n==null?void 0:n.map(e=>{let h;return(e==null?void 0:e.applyStatus)===1&&(h=_===(e==null?void 0:e.nickName)?h=s("div",{className:"add-text",children:a._("features_messenger_addition_index_j3tuca3fsx")}):e!=null&&e.initiativeAdd?d("div",{className:"add-text",children:[s(v,{name:"icon_address_book_added",className:"added"}),a._("features_messenger_new_friend_index_0mcf2pkakz")]}):s("div",{className:"add-btn",onClick:X=>{X.stopPropagation(),T({recordId:e==null?void 0:e.recordId.toString(),nickName:e==null?void 0:e.nickName}),q(),N(!0)},children:a._("features_messenger_addition_index_hi1mctpr4u")})),(e==null?void 0:e.initiativeAdd)===!0&&(e==null?void 0:e.applyStatus)===2&&(h=d("div",{className:"add-text",children:[s(v,{name:"icon_address_book_added",className:"added"}),a._("features_messenger_addition_index_j3tuca3fsx")]})),(e==null?void 0:e.initiativeAdd)===!1&&(e==null?void 0:e.applyStatus)===2&&(h=s("div",{className:"add-text",children:a._("features_messenger_addition_index_j3tuca3fsx")})),s("div",{onClick:()=>{D(e)},children:s(F,{crewName:e==null?void 0:e.nickName,right:h,img:e==null?void 0:e.avatarPath,searchValue:l})},e==null?void 0:e.recordId)})})]}),!!(r!=null&&r.length)&&d("div",{className:"new-friends-list",children:[s("div",{className:"new-friends-lis-title",children:a._("features_messenger_new_friend_index_p6tq9ytho9")}),s("div",{children:r==null?void 0:r.map(e=>{let h;return(e==null?void 0:e.initiativeAdd)===!0&&(e==null?void 0:e.applyStatus)===2&&(h=d("div",{className:"add-text",children:[s(v,{name:"icon_address_book_added",className:"added"}),a._("features_messenger_addition_index_j3tuca3fsx")]})),(e==null?void 0:e.initiativeAdd)===!0&&((e==null?void 0:e.applyStatus)===3||(e==null?void 0:e.applyStatus)===1)&&(h=d("div",{className:"add-text",children:[s(v,{name:"icon_address_book_added",className:"added"}),a._("features_messenger_chat_message_custom_red_pocket_message_uqobfipajg")]})),(e==null?void 0:e.initiativeAdd)===!1&&(e==null?void 0:e.applyStatus)===2&&(h=s("div",{className:"add-text",children:a._("features_messenger_addition_index_j3tuca3fsx")})),(e==null?void 0:e.initiativeAdd)===!1&&((e==null?void 0:e.applyStatus)===3||(e==null?void 0:e.applyStatus)===1)&&(h=s("div",{className:"add-text",children:a._("features_messenger_chat_message_custom_red_pocket_message_uqobfipajg")})),s("div",{onClick:()=>{D(e)},children:s(F,{crewName:e==null?void 0:e.nickName,right:h,img:e==null?void 0:e.avatarPath,searchValue:l})},e==null?void 0:e.recordId)})})]})]})}const K=E(G,W),Q=E(z,$);return d("div",{className:Ne["new-friend"],children:[s(le,{titleText:a._("features_messenger_address_book_index_enlckk2obg")}),s("div",{className:"search-input",children:s(R,{type:"text",className:"search-input-comm",prefix:s(v,{name:"icon_chat_search"}),suffix:l.length&&s(v,{name:"icon_chat_delete",onClick:()=>{y("")}}),placeholder:a._("features_group_components_search_input_index_tq98cmscdb"),value:l,onChange:n=>{y(n)}})}),l.length>0&&w.length===0?s("div",{children:s(te,{name:"no_search_result",footerText:a._("features_group_components_search_friend_index_eppdggih18")})}):K,O?s("div",{className:"flex justify-center mt-52",children:s(oe,{})}):!l.length&&Q,p&&s(B,{children:s(L,{title:i==null?void 0:i.nickName,content:a._("features_messenger_addition_index_1fx0wn_hbe"),confirmEvent:()=>{H(i==null?void 0:i.recordId)},cancelEvent:()=>{N(!1)}})})]})}export{xs as default};
