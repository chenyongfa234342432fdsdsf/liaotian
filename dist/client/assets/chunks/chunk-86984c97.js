import{i as p}from"./chunk-d8234155.js";import{p as S}from"./chunk-f3e99ce8.js";import{l as C}from"./chunk-ba3e3861.js";import{r as a}from"./chunk-e9cd8943.js";import{g as U}from"./chunk-b720646a.js";import{I as g}from"./chunk-d80cdd1c.js";/* empty css              */import"./chunk-23179642.js";import{I as Y}from"./chunk-1a70223d.js";import{W as w,a as L,w as F,b as Z,c as G}from"./chunk-e9c2c122.js";import{a as H,c as J}from"./chunk-ff689da6.js";import{N as K}from"./chunk-28c62a8f.js";import{L as Q}from"./chunk-5f195378.js";import{g as X}from"./chunk-53514b52.js";import{L as $}from"./chunk-014979c9.js";import{C as I}from"./chunk-4e694d97.js";import{A as ee}from"./chunk-43f2ddc7.js";import{a as m,j as r,F as j}from"./chunk-c1d16543.js";import"./chunk-634a8a63.js";import"./chunk-09d047a9.js";import"./chunk-acb1a683.js";import"./chunk-cf010ec4.js";import"./chunk-fde55823.js";import"./chunk-36a75920.js";import"./chunk-0feb7138.js";import"./chunk-99b8f121.js";import"./chunk-b4d6f2f0.js";import"./chunk-01660bad.js";import"./chunk-d4125093.js";import"./chunk-c1540bb6.js";import"./chunk-d368c681.js";import"./chunk-e3775f6c.js";import"./chunk-61229905.js";import"./chunk-b745fb4d.js";import"./chunk-ec284ae6.js";import"./chunk-5212edba.js";import"./chunk-6b5946cf.js";/* empty css              */import"./chunk-e7397446.js";import"./chunk-faa47c2c.js";import"./chunk-cd3d6459.js";import"./chunk-ec38f500.js";const se={"address-book":"address-book-index-module__address-book--hCv"};function Ye(){const{addressBookList:o,setAddressBookList:k,setApplyList:O}=H(),[l,N]=a.useState(""),[v,z]=a.useState(),[_,A]=a.useState([]),[b,R]=a.useState(),[W,T]=a.useState(!1),[c,D]=a.useState([]),y=b==null?void 0:b.filter(e=>e.applyStatus===1&&X(e.applyTime)<3&&!e.initiativeAdd?e:null);let f;(c==null?void 0:c.length)===0||c===void 0?f="":f=`${c.length}`;let h;o!=null&&o.length||(h=!1),o!=null&&o.length&&(h=o==null?void 0:o.length);const V=[{ico:"icon_address_book_new_friend",nav:p._("features_messenger_address_book_index_enlckk2obg"),link:"/messenger/new-friend"},{ico:"icon_address_book_group",nav:p._("features_select_contact_index_ursogloihf"),link:"/messenger/my-group"}],P=o==null?void 0:o.filter(e=>{var i;return(i=e.nickName)!=null&&i.toLowerCase().includes(l.toLowerCase())?e:null});a.useEffect(()=>{A(l===""?[]:P)},[l]);function q(e){var n;const i=e==null?void 0:e.reduce((s,t)=>{let d=((t==null?void 0:t.friendRemark)||(t==null?void 0:t.nickName)||"")[0]||"";const u=S(d,{style:S.STYLE_FIRST_LETTER})||[[""]];let x="";return Array.isArray(u)&&u.length>0&&u[0].length>0&&(x=u[0][0].toUpperCase()),/^[A-Za-z]/.test(x)?d=x:d="#",s[d]||(s[d]=[]),s[d].push({...t,isChecked:!1}),s},{});return(n=Object.keys(i||{}))==null?void 0:n.map(s=>({[s]:i[s]}))}function B(e,i){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ#",s=Object.keys(e)[0],t=Object.keys(i)[0],E=n.includes(s)?n.indexOf(s):n.length,d=n.includes(t)?n.indexOf(t):n.length;return E-d}const M=async()=>{const e=await U({}),{isOk:i,data:n}=e||{};i&&n&&R(n)};return a.useEffect(()=>{T(!0),M(),k().then(()=>{T(!1)})},[]),a.useEffect(()=>{const e={biz:w.im,type:L.friendApply},i=n=>{k(),D(s=>[...s,...n])};F.subscribe({subs:e,callback:i,throttleType:Z.increment,throttleTime:G.Market})},[]),a.useEffect(()=>{const e={biz:w.im,type:L.passFriendApply},i=n=>{O(),k()};F.subscribe({subs:e,callback:i})},[]),a.useEffect(()=>{const i=q(o).sort(B);z(i)},[o]),m("div",{className:se["address-book"],children:[r(ee,{titleText:p._("features_messenger_address_book_index_avctih0kfs"),right:r("div",{onClick:()=>{C("/messenger/addition")},children:r(g,{name:"icon_address_book_new_friend1",fontSize:24,className:"icon-address-book-color"})})}),m("div",{className:"scroll-show",children:[r("div",{className:"search-input",children:r(Y,{type:"text",className:"search-input-comm",prefix:r(g,{name:"icon_chat_search"}),suffix:l.length&&r(g,{name:"icon_chat_delete",onClick:()=>{N("")}}),placeholder:p._("features_group_components_search_input_index_tq98cmscdb"),value:l,onChange:e=>{N(e)}})}),r("div",{className:"search-list",children:l.length>0&&_.length===0?r(K,{name:"no_search_result",footerText:p._("features_group_components_search_friend_index_eppdggih18")}):_==null?void 0:_.map(e=>r(I,{crewName:e==null?void 0:e.nickName,searchValue:l},e==null?void 0:e.nickName))}),!l.length&&m(j,{children:[r("div",{className:"address-book-nav",children:V.map(e=>m(a.Fragment,{children:[m("div",{className:"nav-item",onClick:()=>{C(e==null?void 0:e.link)},children:[m("div",{className:"nav-ico-box",children:[e.nav===p._("features_messenger_address_book_index_enlckk2obg")&&(!!(f!=null&&f.length)||!!(y!=null&&y.length))&&r("div",{className:"tips-round"}),r(g,{name:e==null?void 0:e.ico,fontSize:28,className:"icon-color"})]}),r("div",{className:"nav-text",children:e==null?void 0:e.nav})]}),r("div",{className:"item-line"})]},e==null?void 0:e.nav))}),W?r("div",{className:"flex justify-center mt-52",children:r(Q,{})}):m(j,{children:[r("div",{className:"address-book-list",children:v==null?void 0:v.map((e,i)=>r("div",{children:Object.keys(e).map(n=>m("div",{children:[r("div",{className:"group-letter",children:n}),e[n].map((s,t)=>r(a.Fragment,{children:r("div",{onClick:()=>{J({friend:s})},children:r(I,{crewName:(s==null?void 0:s.friendRemark)||(s==null?void 0:s.nickName)||"",img:s==null?void 0:s.avatarPath},s==null?void 0:s.uid)})},s==null?void 0:s.uid))]},n))},i))}),r("div",{className:"people-people-box",children:r("div",{className:"people-people",children:h?p._({id:"features_messenger_address_book_index_o9x9tnvjih",values:{0:h}}):r($,{text:p._("features_messenger_address_book_index_xxp0fwyt5a")})})})]})]})]})]})}export{Ye as default};
