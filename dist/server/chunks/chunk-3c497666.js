import{i18n as l}from"@lingui/core";import R,{forwardRef as q,useImperativeHandle as b,useState as f,useRef as x}from"react";import{useMount as _}from"ahooks";import u from"@nbit/arco";import s from"crypto-js";import{o as E}from"./chunk-86c9a026.js";import{u as S}from"./chunk-33e5f5bc.js";import{d as I}from"./chunk-60db822c.js";import k from"qrcode.react";import w from"html2canvas";import{j as r,a as d}from"./chunk-ea028b12.js";import{N as U}from"./chunk-38fc2cd5.js";import"@nbit/utils";import"./chunk-c4940547.js";import"zustand";import"zustand/middleware";import"react-tracked";import"./chunk-77d12848.js";import"js-cookie";import"store";import"./chunk-20abda34.js";import"immer";import"axios";import"./chunk-687b5088.js";import"make-plural/plurals";import"vike/client/router";import"./chunk-357fcbd2.js";import"./chunk-7a6de6d7.js";import"lodash";import"./chunk-6bf38136.js";import"classnames";import"./chunk-c41c86a9.js";const j=q((a,t)=>{const e=R.useRef(null);return b(t,()=>({downloadQRCode:()=>{e.current&&w(e.current).then(i=>{const m=i.toDataURL("image/png"),o=document.createElement("a");o.href=m,o.download="qrcode.png",o.click()})}})),r("div",{ref:e,children:r(k,{value:a.value,size:260})})}),P="my-qrcode-index-module__scoped--SEH",A={scoped:P};var y,g;const{Image:B,Button:Q}=(g=(y=u)==null?void 0:y.default)!=null&&g.__esModule?u.default:u,z="snra6h1yki7fvgzo",D="46kd4xzguyt1xs3c",M=({encryptString:a})=>{try{const t=s.enc.Utf8.parse(z),e=s.enc.Utf8.parse(D);return s.AES.encrypt(a,t,{iv:e,mode:s.mode.CBC,padding:s.pad.Pkcs7}).toString()}catch(t){return console.error(t),null}};function he(a,t){const{userInfo:e}=S(),[i,m]=f(""),[o,h]=f(""),p=x(null),C=()=>{I({}).then(n=>{if(n.isOk&&n.data){const c=n.data.find(N=>N.countryEnCode===e.mobileCountryCd);c&&h(c.countryName)}})},v=()=>{p.current&&p.current.downloadQRCode()};return _(async()=>{const n={bundleId:"",type:"1",uid:e.uid,name:e.nickName},c=M({encryptString:JSON.stringify(n)});m(c)}),_(()=>{C()}),d("div",{className:A.scoped,children:[r(U,{label:l._("features_settings_center_my_qrcode_index_g8zmlgrmra"),url:"/settings-center"}),d("div",{className:"qrode-box",children:[d("div",{className:"user-box",children:[r(B,{preview:!1,width:70,className:"headurl",src:e.avatarPath?e.avatarPath:`${E}defaultheadurl.png`}),r("p",{className:"user-name font-medium",children:e.nickName}),r("p",{className:"user-nation",children:e.bindCountry||o})]}),d("div",{className:"qrcode-img",children:[r(j,{value:i,ref:p}),r("p",{className:"tip",children:l._("features_settings_center_my_qrcode_index_gl_brstbj0")}),r(Q,{type:"default",long:!0,className:"save-qrcode font-medium",onClick:v,children:l._("features_messenger_chat_information_qr_code_index_77njplqrds")})]})]})]})}export{he as default};
