import{i18n as c}from"@lingui/core";import{useState as u,useRef as p,useEffect as N}from"react";import g from"@nbit/arco";import{l as j}from"./chunk-75081d50.js";import{I as U}from"./chunk-c41c86a9.js";import{u as A,s as v}from"./chunk-33e5f5bc.js";import{p as q}from"./chunk-9a1033a2.js";import{j as R,k as B}from"./chunk-60db822c.js";import{j as a,a as y}from"./chunk-ea028b12.js";import{N as E}from"./chunk-38fc2cd5.js";import"vike/client/router";import"./chunk-357fcbd2.js";import"@nbit/utils";import"./chunk-7a6de6d7.js";import"zustand";import"react-tracked";import"immer";import"zustand/middleware";import"lodash";import"./chunk-c4940547.js";import"./chunk-77d12848.js";import"js-cookie";import"store";import"./chunk-20abda34.js";import"axios";import"./chunk-687b5088.js";import"make-plural/plurals";import"classnames";import"./chunk-86c9a026.js";import"crypto-js";import"react-dom";import"lottie-react";import"./chunk-13ae7681.js";import"react-dom/client";import"./chunk-6bf38136.js";const K="payment-password-pay-password-component-module__scoped--QZy",M={scoped:K};function x({onComplete:l}){const[d,r]=u(""),n=[p(null),p(null),p(null),p(null),p(null),p(null)],_=(e,t)=>{const s=t.target.value;!isNaN(Number(s))&&s.length<=1&&r(m=>{const i=m.split("");return i[e]=s,i.join("").substr(0,6)})},P=(e,t)=>{var s,m,i,f;t.key==="Backspace"&&e>0&&!((s=n[e].current)!=null&&s.value)?(m=n[e-1].current)==null||m.focus():t.key>="0"&&t.key<="9"&&e<5&&!((i=n[e+1].current)!=null&&i.value)&&((f=n[e+1].current)==null||f.focus())};return N(()=>{var e;(e=n[0].current)==null||e.focus()},[]),N(()=>{l(d)},[d,l]),a("div",{className:M.scoped,children:Array.from({length:6},(e,t)=>a("input",{ref:n[t],type:"password",autoComplete:"off",name:"password",inputMode:"numeric",value:d[t]||"",onChange:s=>_(t,s),onKeyDown:s=>P(t,s),maxLength:1},t))})}const O="payment-password-index-module__scoped--K0o",V={scoped:O};var I,k;const{Message:C}=(k=(I=g)==null?void 0:I.default)!=null&&k.__esModule?g.default:g;function xe(){const{userInfo:l,setUserInfo:d}=A(),[r,n]=u(l.isSetPayPassword),[_,P]=u(""),[e,t]=u(""),[s,m]=u(""),i=o=>{console.log(o),r===1?P(o):r===2?t(o):r===3&&m(o)},f=()=>{r===1?b():r===2?n(3):r===3&&(e===s?S():C.error(c._("features_settings_center_payment_password_index_owexdwtjn1")))},h=o=>o.length===6,S=()=>{R({newPayPassword:v.encryptAES(s,!0)}).then(o=>{if(o.isOk&&o.data){const w={...l,isSetPayPassword:1};d(w),C.success(c._("features_settings_center_payment_password_index_d33sm6ilif")),j("/account-security")}})},b=()=>{B({payPassword:v.encryptAES(_,!0)}).then(async o=>{var w;o.isOk&&o.data&&((w=o.data)!=null&&w.success?n(2):await q(c._("helper_message_fugvl05ct4"),c._("features_settings_center_payment_password_index_6nfwnl8vww")))})};return y("div",{className:V.scoped,children:[a(E,{label:c._("features_settings_center_account_security_index_pjf7yxwuko"),url:"/account-security"}),r===1&&y("div",{className:"password-box",children:[a("p",{className:"text-text_color_01 text-sm mb-8",children:c._("features_settings_center_payment_password_index_xtjkevmaup")}),a(x,{onComplete:i})]}),r===2&&y("div",{className:"password-box",children:[a("p",{className:"text-text_color_01 text-sm mb-8",children:c._("features_settings_center_payment_password_index_x3wuxeeqqh")}),a(x,{onComplete:i})]}),r===3&&y("div",{className:"password-box",children:[a("p",{className:"text-text_color_01 text-sm mb-8",children:c._("features_settings_center_payment_password_index_nb4lzojj89")}),a(x,{onComplete:i})]}),(h(_)||h(e)||h(s))&&a("div",{className:"commit-btn",onClick:f,children:a(U,{name:"icon_set_confirm",fontSize:24,className:"commit-icon"})})]})}export{xe as default};
