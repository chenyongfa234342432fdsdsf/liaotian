import{i18n as l}from"@lingui/core";import{useState as c,useEffect as x}from"react";import{u as R}from"./chunk-1b3433e3.js";import{l as I}from"./chunk-75081d50.js";import{I as C}from"./chunk-c41c86a9.js";import{u as k}from"./chunk-33e5f5bc.js";import{n as j}from"./chunk-4d9fa2e4.js";import{n as G,o as V,q as z,d as E}from"./chunk-60db822c.js";import{g as L,p as T}from"./chunk-eddfc2c9.js";import g from"@nbit/arco";import{C as U}from"./chunk-a6cae7c5.js";import{a as n,j as t,F as B}from"./chunk-ea028b12.js";import{N as D}from"./chunk-38fc2cd5.js";import"./chunk-20abda34.js";import"@nbit/utils";import"vike/client/router";import"./chunk-357fcbd2.js";import"./chunk-7a6de6d7.js";import"zustand";import"react-tracked";import"immer";import"zustand/middleware";import"lodash";import"./chunk-c4940547.js";import"./chunk-77d12848.js";import"js-cookie";import"store";import"axios";import"./chunk-687b5088.js";import"make-plural/plurals";import"classnames";import"./chunk-86c9a026.js";import"crypto-js";import"./chunk-6bf38136.js";const F="verify-identidy-logout-modal-module__popbox--8El",P={popbox:F};var N,v;const{Modal:Q}=(v=(N=g)==null?void 0:N.default)!=null&&v.__esModule?g.default:g,$=l._("features_settings_center_verify_identidy_logout_modal_da0pfanyhk");function H({visible:b,verifyCode:i,onCommit:h}){const{userInfo:d,clearUserCacheData:u}=k(),[r,m]=c([]),_=()=>{G({}).then(e=>{e.isOk&&e.data&&(e.data.length?m(e.data):y())})},y=()=>{let e;d.mobileNumber?e={mobileCountryCd:d.mobileCountryCd,mobileNumber:d.mobileNumber,verifyCode:i}:e={email:d.email,verifyCode:i},V(e).then(f=>{f.isOk&&f.data&&u()})},p=()=>{r.length?h():I("/login")};return x(()=>{_()},[]),n(Q,{className:P.popbox,closable:!1,style:{height:"auto"},title:t("div",{style:{textAlign:"left"},children:l._("features_settings_center_account_security_index_kkqlfhbqu1")}),visible:b,okText:$,onOk:p,children:[r.length?n("div",{className:"chat-list",children:[t("p",{className:"text-text_color_02 text-sm",children:l._("features_settings_center_verify_identidy_logout_modal_p99v97gjhc")}),t("ul",{className:"h-auto overflow-y-auto w-full list-box",children:r.map(e=>n("li",{className:"flex justify-start h-10 items-center mt-4",children:[t(U,{size:40,className:"rounded-img",src:e.headImage}),t("span",{className:"text-base text-text_color_01 ml-3",children:e.groupName})]},e.groupId))})]}):null,!r.length&&n("div",{className:"flex items-center",children:[t(C,{name:"icon_set_logout_successful",fontSize:20,className:"text-brand_color"}),t("span",{className:"text-lg text-text_color_01 ml-3",children:l._("features_settings_center_verify_identidy_logout_modal_yqxwa5wm8p")})]})]})}const J="verify-identidy-index-module__scoped--wtg",K={scoped:J};function Me(){const b=R(),{userInfo:i}=k(),[h,d]=c("");c("86"),c("");const[u,r]=c(""),[m,_]=c(0),[y,p]=c(!1),{url:e}=b.urlParsed.search,f=()=>{i.mobileNumber?q():w()},q=()=>{let o={mobileNumber:i.mobileNumber,mobileCountryCd:i.mobileCountryCd,typeCd:e==="logout"?"24":"99"};L(o).then(s=>{var a;s.isOk&&((a=s.data)!=null&&a.success)&&_(60)})},w=()=>{let o={email:i.email,typeCd:e==="/logout"?"24":"99"};T(o).then(s=>{var a;s.isOk&&((a=s.data)!=null&&a.success)&&_(60)})},S=o=>{j.test(o)?r(o):r("")},A=()=>{z({mobileTelCode:u}).then(s=>{var a;if(s.isOk&&((a=s.data)!=null&&a.success)){if(e==="/logout"){p(!0);return}I(e)}})},M=()=>{E({}).then(o=>{if(o.isOk&&o.data){const s=o.data.find(a=>a.countryEnCode===i.mobileCountryCd);s&&d(s.countryName)}})},O=()=>{p(!1)};return x(()=>{M()},[]),x(()=>{let o=null;return m>0?o=setInterval(()=>{_(s=>s-1)},1e3):clearInterval(o),()=>{o&&clearInterval(o)}},[m]),n(B,{children:[n("div",{className:K.scoped,children:[t(D,{label:l._("features_settings_center_verify_identidy_index_ddqe9vbya0"),url:"/account-security"}),n("div",{className:"vefify-box",children:[n("div",{className:"flex flex-col pt-7 w-full items-center justify-center h-40 pb-7",children:[t(C,{name:"icon_set_verify_identidy",fontSize:50,className:"text-brand_color"}),t("h3",{className:"text-lg text-text_color_01 mt-3",children:l._("features_settings_center_verify_identidy_index_27w9ced7x_")})]}),n("div",{className:"mobile-box",children:[t("div",{className:"list-item cursor-pointer",children:t("span",{className:"area",children:h})}),i.mobileNumber&&n("div",{className:"list-item",children:[n("span",{className:"area-code",children:["+",i.mobileCountryCd]}),t("span",{className:"mobile",children:i.mobileNumber})]}),!i.mobileNumber&&t("div",{className:"list-item",children:t("span",{className:"mobile",children:i.email})}),n("div",{className:"list-item",style:{border:"none"},children:[t("input",{type:"text",value:u,placeholder:i.mobileNumber?l._("features_settings_center_bind_mobile_index_avn5naqutc"):l._("features_settings_center_verify_identidy_index_rwtzuuhnki"),className:"code",onChange:o=>S(o.target.value)}),t("button",{onClick:f,disabled:m>0,className:"getcode",type:"button",children:m>0?`${m}s`:l._("features_settings_center_bind_mobile_index_6ar4vb1hlx")})]})]}),u&&t("div",{className:"commit-btn",onClick:A,children:t(C,{name:e==="/logout"?"icon_set_confirm":"icon_set_next_step",fontSize:e==="/logout"?24:34,className:"commit-icon"})})]})]}),e==="/logout"&&t(H,{visible:y,verifyCode:u,onCommit:O})]})}export{Me as default};
