import{i18n as p}from"@lingui/core";import L from"pinyin";import{l as S}from"./chunk-75081d50.js";import{useState as d,useEffect as f,Fragment as F}from"react";import{a as H}from"./chunk-8d494217.js";import{I as k}from"./chunk-c41c86a9.js";import A from"@nbit/arco";import{W as j,a as I,w as O,b as J,c as K}from"./chunk-30329d74.js";import{u as Q,d as X}from"./chunk-afa2f5f1.js";import{N as ee}from"./chunk-4bfa64b6.js";import{L as se}from"./chunk-bbab396b.js";import{g as re}from"./chunk-53514b52.js";import{L as ie}from"./chunk-c04e2975.js";import{C as z}from"./chunk-e17c2dfa.js";import{A as ne}from"./chunk-a28ca130.js";import{a as m,j as r,F as R}from"./chunk-ea028b12.js";import"vike/client/router";import"./chunk-357fcbd2.js";import"@nbit/utils";import"./chunk-7a6de6d7.js";import"zustand";import"react-tracked";import"immer";import"zustand/middleware";import"lodash";import"./chunk-c4940547.js";import"./chunk-77d12848.js";import"js-cookie";import"store";import"./chunk-20abda34.js";import"axios";import"./chunk-687b5088.js";import"make-plural/plurals";import"./chunk-33e5f5bc.js";import"crypto-js";import"classnames";import"./chunk-86c9a026.js";import"@protobuf-ts/runtime";import"dayjs";import"./chunk-61a1b424.js";import"./chunk-9a1033a2.js";import"react-dom";import"lottie-react";import"./chunk-13ae7681.js";import"react-dom/client";import"./chunk-2fc83edf.js";import"dayjs/plugin/utc.js";import"dayjs/plugin/timezone.js";import"dayjs/plugin/customParseFormat.js";import"./chunk-38b7cb18.js";import"react-lazy-load-image-component";import"ahooks";import"react-highlight-words";import"./chunk-a6cae7c5.js";const oe={"address-book":"address-book-index-module__address-book--hCv"};var W,D;const{Input:ae}=(D=(W=A)==null?void 0:W.default)!=null&&D.__esModule?A.default:A;function ls(){const{addressBookList:o,setAddressBookList:v,setApplyList:V}=Q(),[t,T]=d(""),[b,M]=d(),[h,C]=d([]),[y,P]=d(),[q,w]=d(!1),[c,B]=d([]),N=y==null?void 0:y.filter(e=>e.applyStatus===1&&re(e.applyTime)<3&&!e.initiativeAdd?e:null);let _;(c==null?void 0:c.length)===0||c===void 0?_="":_=`${c.length}`;let u;o!=null&&o.length||(u=!1),o!=null&&o.length&&(u=o==null?void 0:o.length);const U=[{ico:"icon_address_book_new_friend",nav:p._("features_messenger_address_book_index_enlckk2obg"),link:"/messenger/new-friend"},{ico:"icon_address_book_group",nav:p._("features_select_contact_index_ursogloihf"),link:"/messenger/my-group"}],Y=o==null?void 0:o.filter(e=>{var n;return(n=e.nickName)!=null&&n.toLowerCase().includes(t.toLowerCase())?e:null});f(()=>{C(t===""?[]:Y)},[t]);function Z(e){var i;const n=e==null?void 0:e.reduce((s,a)=>{let l=((a==null?void 0:a.friendRemark)||(a==null?void 0:a.nickName)||"")[0]||"";const g=L(l,{style:L.STYLE_FIRST_LETTER})||[[""]];let x="";return Array.isArray(g)&&g.length>0&&g[0].length>0&&(x=g[0][0].toUpperCase()),/^[A-Za-z]/.test(x)?l=x:l="#",s[l]||(s[l]=[]),s[l].push({...a,isChecked:!1}),s},{});return(i=Object.keys(n||{}))==null?void 0:i.map(s=>({[s]:n[s]}))}function $(e,n){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ#",s=Object.keys(e)[0],a=Object.keys(n)[0],E=i.includes(s)?i.indexOf(s):i.length,l=i.includes(a)?i.indexOf(a):i.length;return E-l}const G=async()=>{const e=await H({}),{isOk:n,data:i}=e||{};n&&i&&P(i)};return f(()=>{w(!0),G(),v().then(()=>{w(!1)})},[]),f(()=>{const e={biz:j.im,type:I.friendApply},n=i=>{v(),B(s=>[...s,...i])};O.subscribe({subs:e,callback:n,throttleType:J.increment,throttleTime:K.Market})},[]),f(()=>{const e={biz:j.im,type:I.passFriendApply},n=i=>{V(),v()};O.subscribe({subs:e,callback:n})},[]),f(()=>{const n=Z(o).sort($);M(n)},[o]),m("div",{className:oe["address-book"],children:[r(ne,{titleText:p._("features_messenger_address_book_index_avctih0kfs"),right:r("div",{onClick:()=>{S("/messenger/addition")},children:r(k,{name:"icon_address_book_new_friend1",fontSize:24,className:"icon-address-book-color"})})}),m("div",{className:"scroll-show",children:[r("div",{className:"search-input",children:r(ae,{type:"text",className:"search-input-comm",prefix:r(k,{name:"icon_chat_search"}),suffix:t.length&&r(k,{name:"icon_chat_delete",onClick:()=>{T("")}}),placeholder:p._("features_group_components_search_input_index_tq98cmscdb"),value:t,onChange:e=>{T(e)}})}),r("div",{className:"search-list",children:t.length>0&&h.length===0?r(ee,{name:"no_search_result",footerText:p._("features_group_components_search_friend_index_eppdggih18")}):h==null?void 0:h.map(e=>r(z,{crewName:e==null?void 0:e.nickName,searchValue:t},e==null?void 0:e.nickName))}),!t.length&&m(R,{children:[r("div",{className:"address-book-nav",children:U.map(e=>m(F,{children:[m("div",{className:"nav-item",onClick:()=>{S(e==null?void 0:e.link)},children:[m("div",{className:"nav-ico-box",children:[e.nav===p._("features_messenger_address_book_index_enlckk2obg")&&(!!(_!=null&&_.length)||!!(N!=null&&N.length))&&r("div",{className:"tips-round"}),r(k,{name:e==null?void 0:e.ico,fontSize:28,className:"icon-color"})]}),r("div",{className:"nav-text",children:e==null?void 0:e.nav})]}),r("div",{className:"item-line"})]},e==null?void 0:e.nav))}),q?r("div",{className:"flex justify-center mt-52",children:r(se,{})}):m(R,{children:[r("div",{className:"address-book-list",children:b==null?void 0:b.map((e,n)=>r("div",{children:Object.keys(e).map(i=>m("div",{children:[r("div",{className:"group-letter",children:i}),e[i].map((s,a)=>r(F,{children:r("div",{onClick:()=>{X({friend:s})},children:r(z,{crewName:(s==null?void 0:s.friendRemark)||(s==null?void 0:s.nickName)||"",img:s==null?void 0:s.avatarPath},s==null?void 0:s.uid)})},s==null?void 0:s.uid))]},i))},n))}),r("div",{className:"people-people-box",children:r("div",{className:"people-people",children:u?p._({id:"features_messenger_address_book_index_o9x9tnvjih",values:{0:u}}):r(ie,{text:p._("features_messenger_address_book_index_xxp0fwyt5a")})})})]})]})]})]})}export{ls as default};
